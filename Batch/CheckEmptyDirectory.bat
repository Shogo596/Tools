@echo off

rem ======================================================================================================
rem 【空ディレクトリ検索.bat】
rem バッチ実行時のカレントディレクトリに存在する空フォルダの一覧を出力する。
rem 引数に調査対象のディレクトリを指定する。
rem ======================================================================================================

echo ☆☆処理開始☆☆
echo.

rem ----------------------------------------------------------------------------------------
rem 現在ディレクトリに移動
rem ----------------------------------------------------------------------------------------
cd %~dp0
set DIR_NAME=%CD%

rem ----------------------------------------------------------------------------------------
rem 引数チェック。引数があればセット
rem ----------------------------------------------------------------------------------------
if not "%~1"=="" (
	set DIR_NAME=%~1
)

rem ----------------------------------------------------------------------------------------
rem 空ディレクトリの検索
rem ----------------------------------------------------------------------------------------
echo 以下、空のディレクトリ
echo ----
for /f "delims=" %%d in ('dir /ad /b /s %DIR_NAME%') do call :sub "%%d"
echo ----

rem ----------------------------------------------------------------------------------------
rem 終了処理
rem ----------------------------------------------------------------------------------------
:exit
echo.
echo ☆☆処理終了☆☆
pause
exit /b

:sub
for /f "tokens=1-3" %%a in ('dir %1 ^| find "個のファイル"') do set fnum=%%a & set fsize=%%c
set fsize=%fsize:,=%
for /f "tokens=1" %%a in ('dir %1 ^| find "個のディレクトリ"') do set dir=%%a
if %fnum% EQU 0 if %fsize% EQU 0 if %dir% EQU 2 echo %1
goto :EOF
